<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FlowDesk â€” OFM Agency CRM</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,400&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOKENS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
:root {
  --bg:       #07090e;
  --s1:       #0c0f17;
  --s2:       #111520;
  --s3:       #181d2a;
  --s4:       #1f2535;
  --s5:       #263044;
  --border:   rgba(255,255,255,0.06);
  --border2:  rgba(255,255,255,0.11);
  --border3:  rgba(255,255,255,0.17);
  --accent:   #7c5cfc;
  --accent2:  #a78bfa;
  --accent3:  #c4b5fd;
  --glow:     rgba(124,92,252,0.22);
  --green:    #22c55e;
  --green-bg: rgba(34,197,94,0.1);
  --red:      #f43f5e;
  --red-bg:   rgba(244,63,94,0.1);
  --yellow:   #f59e0b;
  --yellow-bg:rgba(245,158,11,0.1);
  --cyan:     #22d3ee;
  --text:     #eef2f8;
  --text2:    #8b98b4;
  --text3:    #424f6b;
  --r:        10px;
  --r2:       14px;
  --sidebar:  220px;
  --topbar:   50px;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   RESET
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;overflow:hidden}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);display:flex;flex-direction:column}
button,input,textarea,select{font-family:inherit}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--s5);border-radius:2px}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOP BAR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.topbar{
  height:var(--topbar);
  background:var(--s1);
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;
  padding:0 20px;gap:14px;
  flex-shrink:0;z-index:200;
}
.logo{
  font-family:'Syne',sans-serif;font-weight:800;font-size:16px;
  letter-spacing:-0.5px;
  background:linear-gradient(135deg,#fff 20%,var(--accent3));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  display:flex;align-items:center;gap:7px;
  white-space:nowrap;flex-shrink:0;
}
.logo-icon{font-size:14px;-webkit-text-fill-color:initial}

.topbar-divider{width:1px;height:22px;background:var(--border2);flex-shrink:0}

/* breadcrumb / page title */
.page-title{font-size:13px;color:var(--text2);font-weight:400}
.page-title strong{color:var(--text);font-weight:600}

.topbar-right{margin-left:auto;display:flex;align-items:center;gap:10px}

.pill{
  display:flex;align-items:center;gap:5px;
  padding:5px 12px;border-radius:20px;
  border:1px solid var(--border);
  background:var(--s3);
  font-size:11px;color:var(--text2);
  cursor:pointer;transition:all .15s;white-space:nowrap;
}
.pill:hover{border-color:var(--border2);color:var(--text)}
.pulse-dot{width:6px;height:6px;border-radius:50%;background:var(--green);animation:pulseAnim 2s infinite}
@keyframes pulseAnim{0%,100%{opacity:1}50%{opacity:.3}}

.avatar-chip{
  width:28px;height:28px;border-radius:50%;
  background:linear-gradient(135deg,var(--accent),#a855f7);
  display:flex;align-items:center;justify-content:center;
  font-size:11px;font-weight:700;color:white;cursor:pointer;
  border:2px solid var(--border2);flex-shrink:0;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   APP SHELL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.app-shell{flex:1;display:flex;overflow:hidden}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SIDEBAR NAV
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar{
  width:var(--sidebar);min-width:var(--sidebar);
  background:var(--s1);
  border-right:1px solid var(--border);
  display:flex;flex-direction:column;
  overflow:hidden;flex-shrink:0;
}

.nav-section{padding:16px 12px 6px;font-size:9px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--text3)}

.nav-item{
  display:flex;align-items:center;gap:10px;
  padding:8px 14px;margin:1px 6px;border-radius:8px;
  cursor:pointer;color:var(--text2);font-size:13px;font-weight:400;
  transition:all .12s;position:relative;
  border:1px solid transparent;
}
.nav-item:hover{background:var(--s3);color:var(--text)}
.nav-item.active{
  background:rgba(124,92,252,0.12);color:var(--text);
  border-color:rgba(124,92,252,0.2);
}
.nav-item.active .nav-icon{color:var(--accent2)}
.nav-icon{font-size:14px;width:18px;text-align:center;flex-shrink:0}
.nav-badge{
  margin-left:auto;background:var(--accent);color:white;
  font-size:9px;font-weight:700;padding:2px 6px;border-radius:10px;min-width:18px;text-align:center;
}
.nav-badge.green{background:rgba(34,197,94,0.2);color:var(--green)}

.sidebar-footer{
  margin-top:auto;padding:12px;border-top:1px solid var(--border);
}
.sidebar-user{
  display:flex;align-items:center;gap:9px;
  padding:8px 10px;border-radius:8px;cursor:pointer;
  transition:background .12s;
}
.sidebar-user:hover{background:var(--s3)}
.sidebar-user-info{flex:1;min-width:0}
.sidebar-user-name{font-size:12px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sidebar-user-role{font-size:10px;color:var(--text3)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MAIN CONTENT AREA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main{flex:1;overflow:hidden;display:flex;flex-direction:column}

/* PAGE â€” base */
.page{display:none;flex:1;overflow-y:auto;padding:24px;flex-direction:column;gap:20px}
.page.active{display:flex}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SHARED COMPONENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.card{
  background:var(--s1);border:1px solid var(--border);
  border-radius:var(--r2);
}
.card-header{
  padding:16px 20px;border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;
}
.card-title{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;color:var(--text)}
.card-subtitle{font-size:12px;color:var(--text3);margin-top:2px}
.card-body{padding:20px}

.stat-card{
  background:var(--s1);border:1px solid var(--border);border-radius:var(--r2);
  padding:18px 20px;position:relative;overflow:hidden;
  transition:border-color .2s,transform .15s;cursor:default;
}
.stat-card:hover{border-color:var(--border2);transform:translateY(-1px)}
.stat-card::before{
  content:'';position:absolute;top:-40px;right:-40px;
  width:100px;height:100px;border-radius:50%;
  background:var(--accent-glow,rgba(255,255,255,0.02));
  pointer-events:none;
}
.stat-label{font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px}
.stat-value{font-family:'Syne',sans-serif;font-size:26px;font-weight:700;color:var(--text);line-height:1}
.stat-sub{font-size:11px;color:var(--text2);margin-top:5px;display:flex;align-items:center;gap:4px}
.stat-up{color:var(--green)}.stat-down{color:var(--red)}

.btn{
  display:inline-flex;align-items:center;gap:6px;
  padding:7px 14px;border-radius:8px;font-size:13px;font-weight:500;
  cursor:pointer;border:none;transition:all .12s;
}
.btn-primary{background:var(--accent);color:white;box-shadow:0 0 20px var(--glow)}
.btn-primary:hover{background:#6d4fe0;transform:translateY(-1px)}
.btn-ghost{background:var(--s3);color:var(--text2);border:1px solid var(--border)}
.btn-ghost:hover{color:var(--text);border-color:var(--border2)}
.btn-sm{padding:5px 10px;font-size:12px;border-radius:7px}
.btn-danger{background:var(--red-bg);color:var(--red);border:1px solid rgba(244,63,94,0.2)}
.btn-danger:hover{background:rgba(244,63,94,0.2)}

.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:5px;font-size:10px;font-weight:600;letter-spacing:.3px}
.badge-green{background:var(--green-bg);color:var(--green)}
.badge-red{background:var(--red-bg);color:var(--red)}
.badge-yellow{background:var(--yellow-bg);color:var(--yellow)}
.badge-purple{background:rgba(124,92,252,0.15);color:var(--accent2)}
.badge-whale{background:rgba(124,92,252,0.15);color:var(--accent2)}
.badge-dolphin{background:var(--yellow-bg);color:var(--yellow)}
.badge-low{background:var(--s3);color:var(--text3);border:1px solid var(--border)}

/* grid helpers */
.grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
.flex-row{display:flex;align-items:center;gap:10px}
.flex-between{display:flex;align-items:center;justify-content:space-between}
.gap-6{gap:6px}.gap-10{gap:10px}.gap-14{gap:14px}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PAGE: DASHBOARD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.page-header{display:flex;align-items:flex-start;justify-content:space-between;gap:16px;margin-bottom:4px}
.page-heading{font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--text)}
.page-sub{font-size:13px;color:var(--text3);margin-top:3px}

/* Activity feed */
.activity-feed{display:flex;flex-direction:column;gap:0}
.activity-item{
  display:flex;align-items:center;gap:12px;
  padding:10px 0;border-bottom:1px solid var(--border);
}
.activity-item:last-child{border-bottom:none}
.activity-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.activity-text{font-size:12px;color:var(--text2);flex:1}
.activity-text strong{color:var(--text)}
.activity-time{font-size:10px;color:var(--text3);white-space:nowrap}
.activity-amount{font-size:12px;font-weight:600;color:var(--green);white-space:nowrap}

/* Account cards */
.account-card{
  background:var(--s1);border:1px solid var(--border);border-radius:var(--r2);
  padding:16px;transition:all .15s;cursor:pointer;
}
.account-card:hover{border-color:var(--border2);transform:translateY(-1px)}
.account-avatar{
  width:48px;height:48px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:20px;font-weight:700;color:white;margin-bottom:12px;
  position:relative;
}
.account-avatar-status{
  position:absolute;bottom:0;right:0;
  width:12px;height:12px;border-radius:50%;background:var(--green);
  border:2px solid var(--s1);
}
.account-name{font-size:14px;font-weight:600;color:var(--text);margin-bottom:2px}
.account-handle{font-size:11px;color:var(--text3);margin-bottom:10px}
.account-stats{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.account-stat{background:var(--s3);border-radius:7px;padding:7px 9px}
.account-stat-label{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px}
.account-stat-value{font-size:14px;font-weight:600;color:var(--text)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PAGE: MESSAGE PRO
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.msgpro-shell{
  flex:1;display:flex;overflow:hidden;
  margin:-24px;/* bleed to edges */
}

/* Model tabs strip */
.model-strip{
  height:44px;
  background:var(--s1);border-bottom:1px solid var(--border);
  display:flex;align-items:center;
  padding:0 14px;gap:4px;
  flex-shrink:0;overflow-x:auto;
}
.model-strip::-webkit-scrollbar{display:none}

.model-tab{
  display:flex;align-items:center;gap:7px;
  padding:5px 11px 5px 7px;border-radius:8px;
  cursor:pointer;color:var(--text2);font-size:12px;
  transition:all .12s;white-space:nowrap;border:1px solid transparent;
  flex-shrink:0;
}
.model-tab:hover{background:var(--s3);color:var(--text)}
.model-tab.active{background:rgba(124,92,252,0.12);color:var(--text);border-color:rgba(124,92,252,0.25)}
.model-tab-av{width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;color:white;flex-shrink:0}
.model-tab-unread{background:var(--accent);color:white;font-size:9px;font-weight:700;padding:1px 5px;border-radius:10px;min-width:16px;text-align:center}

.add-acct-btn{
  width:28px;height:28px;border-radius:7px;background:transparent;
  border:1px dashed var(--border2);display:flex;align-items:center;justify-content:center;
  cursor:pointer;color:var(--text3);font-size:14px;transition:all .12s;flex-shrink:0;
}
.add-acct-btn:hover{border-color:var(--accent);color:var(--accent2)}

/* Inbox rail */
.inbox-rail{
  width:280px;min-width:260px;
  background:var(--s1);border-right:1px solid var(--border);
  display:flex;flex-direction:column;flex-shrink:0;
}
.inbox-top{padding:10px 12px;border-bottom:1px solid var(--border)}
.inbox-search{
  width:100%;background:var(--s3);border:1px solid var(--border);
  border-radius:7px;padding:6px 10px;font-size:12px;color:var(--text);
  outline:none;transition:border-color .15s;margin-bottom:7px;
}
.inbox-search:focus{border-color:var(--accent)}
.inbox-search::placeholder{color:var(--text3)}
.inbox-filters{display:flex;gap:4px;flex-wrap:wrap}
.ifilter{
  font-size:10px;font-weight:500;padding:3px 9px;border-radius:20px;
  border:1px solid var(--border);cursor:pointer;color:var(--text2);
  background:transparent;transition:all .1s;
}
.ifilter:hover{border-color:var(--border2);color:var(--text)}
.ifilter.active{background:rgba(124,92,252,0.15);border-color:rgba(124,92,252,0.3);color:var(--accent2)}

.inbox-list{flex:1;overflow-y:auto}
.convo-row{
  padding:10px 12px;cursor:pointer;
  border-bottom:1px solid var(--border);transition:background .1s;
  border-left:2px solid transparent;
}
.convo-row:hover{background:var(--s2)}
.convo-row.active{background:rgba(124,92,252,0.07);border-left-color:var(--accent)}
.cr-top{display:flex;align-items:center;gap:8px;margin-bottom:4px}
.cr-av{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:white;flex-shrink:0;position:relative}
.cr-av-online::after{content:'';position:absolute;bottom:0;right:0;width:9px;height:9px;background:var(--green);border-radius:50%;border:2px solid var(--s1)}
.cr-name{font-size:12px;font-weight:500;color:var(--text);flex:1}
.cr-time{font-size:10px;color:var(--text3)}
.cr-preview{font-size:11px;color:var(--text3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:4px;padding-left:42px}
.cr-meta{display:flex;align-items:center;gap:5px;padding-left:42px}
.cr-unread{background:var(--accent);color:white;font-size:8px;font-weight:700;padding:1px 5px;border-radius:8px;margin-left:auto}

/* Sub-tabs */
.sub-tabs{
  height:36px;background:var(--s2);border-bottom:1px solid var(--border);
  display:flex;align-items:center;padding:0 10px;gap:3px;
  overflow-x:auto;flex-shrink:0;
}
.sub-tabs::-webkit-scrollbar{display:none}
.stab-label{font-size:10px;color:var(--text3);margin-right:3px;white-space:nowrap;flex-shrink:0}
.sub-tab{
  display:flex;align-items:center;gap:5px;
  padding:3px 9px;border-radius:6px;cursor:pointer;
  color:var(--text2);font-size:11px;transition:all .1s;
  white-space:nowrap;border:1px solid transparent;flex-shrink:0;
}
.sub-tab:hover{background:var(--s3);color:var(--text)}
.sub-tab.active{background:var(--s4);color:var(--text);border-color:var(--border2)}
.stab-unread{width:5px;height:5px;border-radius:50%;background:var(--accent)}
.stab-close{font-size:9px;color:var(--text3);padding:1px 2px;border-radius:2px}
.stab-close:hover{color:var(--red)}

/* Chat thread */
.chat-col{flex:1;display:flex;flex-direction:column;overflow:hidden;background:var(--bg)}
.chat-thread-area{flex:1;overflow-y:auto;padding:16px 20px;display:flex;flex-direction:column;gap:3px}
.chat-empty-state{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--text3);gap:8px}
.chat-empty-state .icon{font-size:36px;opacity:.5}

.date-sep{text-align:center;font-size:10px;color:var(--text3);padding:10px 0;position:relative}
.date-sep::before{content:'';position:absolute;top:50%;left:0;right:0;height:1px;background:var(--border)}
.date-sep span{background:var(--bg);padding:0 10px;position:relative;z-index:1}

.msg-row{display:flex;gap:8px;margin-bottom:1px;animation:msgIn .18s ease}
@keyframes msgIn{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}
.msg-row.out{flex-direction:row-reverse}
.msg-av{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:white;flex-shrink:0;align-self:flex-end}
.msg-wrap{display:flex;flex-direction:column;max-width:62%}
.msg-row.out .msg-wrap{align-items:flex-end}
.msg-bubble{
  padding:8px 12px;border-radius:13px;font-size:13px;line-height:1.5;
}
.msg-row.in .msg-bubble{background:var(--s3);color:var(--text);border-bottom-left-radius:4px}
.msg-row.out .msg-bubble{background:rgba(124,92,252,0.18);color:var(--text);border-bottom-right-radius:4px}
.msg-row.out.ppv .msg-bubble{background:rgba(245,158,11,0.12);border:1px solid rgba(245,158,11,0.25)}
.msg-ppv-tag{font-size:9px;font-weight:700;color:var(--yellow);text-transform:uppercase;letter-spacing:.5px;margin-bottom:3px;display:flex;align-items:center;gap:3px}
.msg-meta{font-size:10px;color:var(--text3);margin-top:2px}

/* Lock warning */
.lock-warn{
  margin:0 16px 0;padding:7px 12px;
  background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.25);
  border-radius:8px;font-size:11px;color:var(--yellow);
  display:none;align-items:center;gap:7px;flex-shrink:0;margin-bottom:4px;
}

/* Script runner */
.script-runner{
  border-top:1px solid var(--border);
  padding:10px 14px;background:rgba(124,92,252,0.04);
  flex-shrink:0;display:none;
}
.script-runner.on{display:block}
.sr-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:7px}
.sr-title{font-size:11px;font-weight:600;color:var(--accent2);display:flex;align-items:center;gap:5px}
.sr-progress{display:flex;align-items:center;gap:7px}
.sr-dots{display:flex;gap:3px}
.sr-dot{width:7px;height:7px;border-radius:50%;background:var(--s4);transition:background .2s}
.sr-dot.done{background:var(--green)}.sr-dot.cur{background:var(--accent)}
.sr-step-label{font-size:10px;color:var(--text3)}
.sr-content{
  background:var(--s3);border:1px solid var(--border2);border-radius:8px;
  padding:9px 12px;font-size:13px;color:var(--text);line-height:1.5;margin-bottom:7px;
}
.sr-note{font-size:11px;color:var(--yellow);margin-bottom:7px;display:none;align-items:flex-start;gap:5px}
.sr-note.show{display:flex}
.sr-actions{display:flex;gap:5px;flex-wrap:wrap}

/* Snippets panel */
.snip-panel{border-top:1px solid var(--border);padding:8px 14px;flex-shrink:0;display:none}
.snip-panel.open{display:block}
.snip-search{
  width:100%;background:var(--s3);border:1px solid var(--border);
  border-radius:7px;padding:5px 9px;font-size:11px;color:var(--text);
  outline:none;margin-bottom:6px;
}
.snip-search::placeholder{color:var(--text3)}
.snip-grid{display:flex;gap:5px;flex-wrap:wrap;max-height:80px;overflow-y:auto}
.snip-chip{
  padding:4px 10px;background:var(--s3);border:1px solid var(--border);
  border-radius:7px;font-size:11px;color:var(--text2);cursor:pointer;transition:all .1s;
}
.snip-chip:hover{border-color:var(--accent);color:var(--accent2);background:rgba(124,92,252,0.08)}
.snip-chip.ppv{border-color:rgba(245,158,11,0.3);color:var(--yellow)}

/* Composer */
.composer{border-top:1px solid var(--border);background:var(--s1);flex-shrink:0}
.composer-tools{
  display:flex;align-items:center;gap:5px;
  padding:7px 12px;border-bottom:1px solid var(--border);
}
.tool-btn{
  display:flex;align-items:center;gap:4px;
  padding:4px 9px;border-radius:6px;border:1px solid var(--border);
  background:transparent;cursor:pointer;color:var(--text2);
  font-size:11px;transition:all .12s;
}
.tool-btn:hover{background:var(--s3);color:var(--text);border-color:var(--border2)}
.tool-btn.on{background:rgba(124,92,252,0.12);color:var(--accent2);border-color:rgba(124,92,252,0.3)}
.tool-btn.ppv-on{background:var(--yellow-bg);color:var(--yellow);border-color:rgba(245,158,11,0.3)}
.ppv-price{
  width:60px;padding:3px 7px;background:var(--s3);
  border:1px solid rgba(245,158,11,0.4);border-radius:6px;
  color:var(--yellow);font-size:11px;outline:none;display:none;
}
.char-ct{margin-left:auto;font-size:10px;color:var(--text3);font-family:'DM Mono',monospace}
.composer-row{display:flex;align-items:flex-end;gap:8px;padding:9px 12px}
.composer-ta{
  flex:1;background:var(--s3);border:1px solid var(--border2);
  border-radius:10px;padding:9px 13px;font-size:13px;color:var(--text);
  resize:none;outline:none;min-height:40px;max-height:110px;line-height:1.5;
  transition:border-color .15s;
}
.composer-ta:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(124,92,252,0.08)}
.composer-ta::placeholder{color:var(--text3)}
.send-btn{
  width:38px;height:38px;border-radius:9px;background:var(--accent);
  border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;
  color:white;font-size:16px;transition:all .15s;flex-shrink:0;
  box-shadow:0 0 18px var(--glow);
}
.send-btn:hover{background:#6d4fe0;transform:translateY(-1px)}
.send-btn.ppv-mode{background:var(--yellow);box-shadow:0 0 18px rgba(245,158,11,0.3)}

/* CRM panel */
.crm-panel{
  width:280px;min-width:260px;
  background:var(--s1);border-left:1px solid var(--border);
  display:flex;flex-direction:column;overflow-y:auto;flex-shrink:0;
}
.crm-sec{padding:14px;border-bottom:1px solid var(--border)}
.crm-sec-title{font-size:9px;font-weight:700;letter-spacing:1.2px;text-transform:uppercase;color:var(--text3);margin-bottom:10px}
.fan-head{display:flex;align-items:center;gap:9px}
.fan-av-lg{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;color:white;flex-shrink:0}
.fan-name{font-size:14px;font-weight:600;color:var(--text)}
.fan-handle{font-size:11px;color:var(--text3)}
.stat-row-sm{display:flex;justify-content:space-between;align-items:center;margin-bottom:7px}
.srs-label{font-size:11px;color:var(--text2)}
.srs-value{font-size:12px;font-weight:600;color:var(--text)}
.srs-value.green{color:var(--green)}.srs-value.accent{color:var(--accent2)}
.tags-row{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px}
.tag-chip-sm{
  display:flex;align-items:center;gap:3px;
  padding:2px 7px;border-radius:4px;
  background:var(--s3);border:1px solid var(--border);font-size:10px;color:var(--text2);
}
.tag-rm{cursor:pointer;color:var(--text3);font-size:9px;transition:color .1s}
.tag-rm:hover{color:var(--red)}
.tag-add-row{display:flex;gap:4px}
.tag-input{
  flex:1;padding:4px 8px;background:var(--s3);border:1px solid var(--border);
  border-radius:6px;font-size:11px;color:var(--text);outline:none;
}
.tag-input:focus{border-color:var(--accent)}
.notes-ta{
  width:100%;background:var(--s3);border:1px solid var(--border);
  border-radius:7px;padding:7px 9px;font-size:11px;color:var(--text);
  resize:none;outline:none;min-height:60px;margin-bottom:6px;line-height:1.4;
}
.notes-ta:focus{border-color:var(--accent)}
.notes-ta::placeholder{color:var(--text3)}
.crm-action-btn{
  width:100%;padding:7px 10px;border-radius:7px;
  border:1px solid var(--border);background:var(--s3);
  color:var(--text2);font-size:11px;cursor:pointer;transition:all .1s;
  text-align:left;display:flex;align-items:center;gap:6px;margin-bottom:4px;
}
.crm-action-btn:hover{background:var(--s4);color:var(--text);border-color:var(--border2)}
.crm-action-btn.accent{background:rgba(124,92,252,0.08);border-color:rgba(124,92,252,0.25);color:var(--accent2)}
.crm-action-btn.accent:hover{background:rgba(124,92,252,0.15)}
.rev-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid var(--border)}
.rev-row:last-child{border-bottom:none}
.rev-type{font-size:11px;color:var(--text2)}.rev-date{font-size:9px;color:var(--text3)}
.rev-amount{font-size:12px;font-weight:600;color:var(--green)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PAGE: ANALYTICS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.chart-bar-container{display:flex;align-items:flex-end;gap:6px;height:120px;padding-top:10px}
.chart-bar-wrap{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}
.chart-bar{
  width:100%;border-radius:4px 4px 0 0;
  background:linear-gradient(to top,var(--accent),var(--accent2));
  min-height:4px;transition:height .4s ease;
  position:relative;
}
.chart-bar:hover::after{
  content:attr(data-val);
  position:absolute;bottom:calc(100% + 4px);left:50%;transform:translateX(-50%);
  background:var(--s3);border:1px solid var(--border2);
  color:var(--text);font-size:10px;padding:2px 6px;border-radius:4px;
  white-space:nowrap;z-index:10;
}
.chart-label{font-size:9px;color:var(--text3);text-align:center}

.leaderboard-row{
  display:flex;align-items:center;gap:10px;
  padding:10px 0;border-bottom:1px solid var(--border);
}
.leaderboard-row:last-child{border-bottom:none}
.lb-rank{font-family:'Syne',sans-serif;font-size:16px;font-weight:700;color:var(--text3);width:22px;text-align:center;flex-shrink:0}
.lb-rank.gold{color:#f59e0b}.lb-rank.silver{color:#94a3b8}.lb-rank.bronze{color:#b45309}
.lb-av{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:white;flex-shrink:0}
.lb-info{flex:1;min-width:0}
.lb-name{font-size:13px;font-weight:500;color:var(--text)}
.lb-stats{font-size:10px;color:var(--text3)}
.lb-revenue{font-size:14px;font-weight:700;color:var(--green);white-space:nowrap}
.lb-bar-wrap{height:4px;background:var(--s4);border-radius:2px;margin-top:4px}
.lb-bar{height:4px;border-radius:2px;background:linear-gradient(90deg,var(--accent),var(--accent2))}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PAGE: TEAM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.team-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
.team-card{
  background:var(--s1);border:1px solid var(--border);border-radius:var(--r2);
  padding:18px;transition:border-color .15s;
}
.team-card:hover{border-color:var(--border2)}
.tc-head{display:flex;align-items:center;gap:10px;margin-bottom:12px}
.tc-av{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;color:white;flex-shrink:0}
.tc-name{font-size:14px;font-weight:600;color:var(--text)}
.tc-role{font-size:11px;color:var(--text3)}
.tc-accounts{font-size:11px;color:var(--text2);margin-bottom:8px}
.tc-metrics{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.tc-metric{background:var(--s3);border-radius:7px;padding:7px 9px}
.tc-metric-label{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.4px}
.tc-metric-value{font-size:14px;font-weight:600;color:var(--text)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PAGE: SCRIPTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.script-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
.script-card{
  background:var(--s1);border:1px solid var(--border);border-radius:var(--r2);
  padding:18px;cursor:pointer;transition:all .15s;
}
.script-card:hover{border-color:var(--accent);transform:translateY(-1px)}
.sc-head{display:flex;align-items:flex-start;justify-content:space-between;gap:8px;margin-bottom:10px}
.sc-name{font-size:14px;font-weight:600;color:var(--text)}
.sc-desc{font-size:11px;color:var(--text3);margin-bottom:12px;line-height:1.4}
.sc-steps{display:flex;flex-direction:column;gap:4px;margin-bottom:12px}
.sc-step-preview{
  display:flex;align-items:flex-start;gap:7px;
  padding:6px 8px;background:var(--s3);border-radius:6px;
}
.sc-step-num{font-size:9px;font-weight:700;color:var(--accent2);width:14px;flex-shrink:0;padding-top:1px}
.sc-step-text{font-size:11px;color:var(--text2);line-height:1.4}
.sc-metrics{display:flex;gap:10px;padding-top:10px;border-top:1px solid var(--border)}
.sc-metric{font-size:11px;color:var(--text2)}
.sc-metric strong{color:var(--green);font-weight:600}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MODAL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.7);
  z-index:1000;display:none;align-items:center;justify-content:center;
  backdrop-filter:blur(4px);
}
.modal-overlay.open{display:flex}
.modal{
  background:var(--s1);border:1px solid var(--border2);border-radius:16px;
  padding:28px;min-width:400px;max-width:520px;width:90%;
  animation:modalIn .2s ease;
}
@keyframes modalIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
.modal-title{font-family:'Syne',sans-serif;font-size:18px;font-weight:700;margin-bottom:5px}
.modal-sub{font-size:13px;color:var(--text3);margin-bottom:20px}
.form-field{margin-bottom:14px}
.form-label{font-size:11px;font-weight:600;color:var(--text2);letter-spacing:.3px;margin-bottom:5px;display:block}
.form-input{
  width:100%;background:var(--s3);border:1px solid var(--border2);
  border-radius:8px;padding:9px 13px;font-size:13px;color:var(--text);
  outline:none;transition:border-color .15s;
}
.form-input:focus{border-color:var(--accent)}
.form-input::placeholder{color:var(--text3)}
.modal-footer{display:flex;justify-content:flex-end;gap:8px;margin-top:20px;padding-top:16px;border-top:1px solid var(--border)}

/* Toast */
#toast{
  position:fixed;bottom:24px;left:50%;transform:translateX(-50%);
  background:var(--s3);border:1px solid var(--border2);border-radius:20px;
  padding:8px 18px;font-size:12px;color:var(--text);
  z-index:9999;opacity:0;transition:opacity .3s;pointer-events:none;white-space:nowrap;
}
</style>
</head>
<body>

<!-- TOP BAR -->
<header class="topbar">
  <div class="logo"><span class="logo-icon">âš¡</span>FlowDesk</div>
  <div class="topbar-divider"></div>
  <div class="page-title" id="pageTitle"><strong>Dashboard</strong></div>
  <div class="topbar-right">
    <div class="pill"><div class="pulse-dot"></div> All systems live</div>
    <div class="pill" onclick="openModal('connectModal')">ï¼‹ Connect account</div>
    <div class="avatar-chip">MT</div>
  </div>
</header>

<!-- APP SHELL -->
<div class="app-shell">

  <!-- SIDEBAR -->
  <nav class="sidebar">
    <div class="nav-section">Main</div>
    <div class="nav-item active" onclick="goTo('dashboard',this)">
      <span class="nav-icon">â–¦</span> Dashboard
    </div>
    <div class="nav-item" onclick="goTo('message-pro',this)">
      <span class="nav-icon">ğŸ’¬</span> Message Pro
      <span class="nav-badge">17</span>
    </div>

    <div class="nav-section">Insights</div>
    <div class="nav-item" onclick="goTo('analytics',this)">
      <span class="nav-icon">ğŸ“ˆ</span> Analytics
    </div>
    <div class="nav-item" onclick="goTo('scripts',this)">
      <span class="nav-icon">â–¶</span> Scripts
    </div>

    <div class="nav-section">Manage</div>
    <div class="nav-item" onclick="goTo('team',this)">
      <span class="nav-icon">ğŸ‘¥</span> Team
    </div>
    <div class="nav-item" onclick="goTo('accounts',this)">
      <span class="nav-icon">ğŸ”—</span> Accounts
      <span class="nav-badge green">3</span>
    </div>

    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="avatar-chip" style="flex-shrink:0">MT</div>
        <div class="sidebar-user-info">
          <div class="sidebar-user-name">Mike Thompson</div>
          <div class="sidebar-user-role">Agency Owner</div>
        </div>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="main">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PAGE: DASHBOARD
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page active" id="page-dashboard">
      <div class="page-header">
        <div>
          <div class="page-heading">Good morning, Mike ğŸ‘‹</div>
          <div class="page-sub">Friday, Feb 20 Â· 3 accounts active Â· 17 unread conversations</div>
        </div>
        <button class="btn btn-primary btn-sm" onclick="goToNav('message-pro')">Open Message Pro â†’</button>
      </div>

      <!-- Stat row -->
      <div class="grid-4">
        <div class="stat-card" style="--accent-glow:rgba(34,197,94,0.15)">
          <div class="stat-label">Today's Revenue</div>
          <div class="stat-value">$1,280</div>
          <div class="stat-sub"><span class="stat-up">â†‘ 18%</span> vs yesterday</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Monthly Revenue</div>
          <div class="stat-value">$14,280</div>
          <div class="stat-sub"><span class="stat-up">â†‘ 12%</span> vs last month</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Active Subscribers</div>
          <div class="stat-value">847</div>
          <div class="stat-sub"><span class="stat-up">+23</span> this week</div>
        </div>
        <div class="stat-card" style="--accent-glow:rgba(245,158,11,0.1)">
          <div class="stat-label">Unread Messages</div>
          <div class="stat-value">17</div>
          <div class="stat-sub">Across 3 models</div>
        </div>
      </div>

      <div class="grid-2" style="gap:16px">
        <!-- Connected Accounts -->
        <div>
          <div style="font-family:'Syne',sans-serif;font-size:14px;font-weight:700;margin-bottom:12px">Connected Models</div>
          <div class="grid-3" style="gap:10px">
            <div class="account-card" onclick="goToNav('message-pro')">
              <div class="account-avatar" style="background:linear-gradient(135deg,#667eea,#764ba2)">
                S <div class="account-avatar-status"></div>
              </div>
              <div class="account-name">Sophia Rose</div>
              <div class="account-handle">@sophiarose</div>
              <div class="account-stats">
                <div class="account-stat"><div class="account-stat-label">Revenue</div><div class="account-stat-value">$5.2k</div></div>
                <div class="account-stat"><div class="account-stat-label">Subs</div><div class="account-stat-value">312</div></div>
                <div class="account-stat"><div class="account-stat-label">Unread</div><div class="account-stat-value" style="color:var(--accent2)">5</div></div>
                <div class="account-stat"><div class="account-stat-label">PPV Rate</div><div class="account-stat-value">68%</div></div>
              </div>
            </div>
            <div class="account-card" onclick="goToNav('message-pro')">
              <div class="account-avatar" style="background:linear-gradient(135deg,#f093fb,#f5576c)">
                A <div class="account-avatar-status"></div>
              </div>
              <div class="account-name">Ava Monroe</div>
              <div class="account-handle">@avamonroe</div>
              <div class="account-stats">
                <div class="account-stat"><div class="account-stat-label">Revenue</div><div class="account-stat-value">$6.1k</div></div>
                <div class="account-stat"><div class="account-stat-label">Subs</div><div class="account-stat-value">401</div></div>
                <div class="account-stat"><div class="account-stat-label">Unread</div><div class="account-stat-value" style="color:var(--accent2)">12</div></div>
                <div class="account-stat"><div class="account-stat-label">PPV Rate</div><div class="account-stat-value">74%</div></div>
              </div>
            </div>
            <div class="account-card" onclick="goToNav('message-pro')">
              <div class="account-avatar" style="background:linear-gradient(135deg,#4facfe,#00f2fe)">
                L <div class="account-avatar-status"></div>
              </div>
              <div class="account-name">Luna Sky</div>
              <div class="account-handle">@lunasky</div>
              <div class="account-stats">
                <div class="account-stat"><div class="account-stat-label">Revenue</div><div class="account-stat-value">$2.9k</div></div>
                <div class="account-stat"><div class="account-stat-label">Subs</div><div class="account-stat-value">134</div></div>
                <div class="account-stat"><div class="account-stat-label">Unread</div><div class="account-stat-value" style="color:var(--text3)">0</div></div>
                <div class="account-stat"><div class="account-stat-label">PPV Rate</div><div class="account-stat-value">51%</div></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Activity Feed -->
        <div class="card">
          <div class="card-header">
            <div><div class="card-title">Live Activity</div><div class="card-subtitle">Real-time revenue events</div></div>
            <div class="pulse-dot"></div>
          </div>
          <div class="card-body" style="padding:0 20px">
            <div class="activity-feed" id="activityFeed"></div>
          </div>
        </div>
      </div>

      <!-- Bottom row -->
      <div class="grid-2">
        <!-- Chatter performance -->
        <div class="card">
          <div class="card-header">
            <div><div class="card-title">Chatter Performance</div><div class="card-subtitle">This month</div></div>
          </div>
          <div class="card-body" style="padding:0">
            <div style="padding:6px 16px">
              <div class="leaderboard-row">
                <div class="lb-rank gold">1</div>
                <div class="lb-av" style="background:linear-gradient(135deg,#f59e0b,#ef4444)">J</div>
                <div class="lb-info">
                  <div class="lb-name">Jake R.</div>
                  <div class="lb-stats">142 msgs Â· 38 PPV sells Â· 92% reply rate</div>
                  <div class="lb-bar-wrap"><div class="lb-bar" style="width:100%"></div></div>
                </div>
                <div class="lb-revenue">$3,840</div>
              </div>
              <div class="leaderboard-row">
                <div class="lb-rank silver">2</div>
                <div class="lb-av" style="background:linear-gradient(135deg,#22d3ee,#3b82f6)">S</div>
                <div class="lb-info">
                  <div class="lb-name">Sara M.</div>
                  <div class="lb-stats">118 msgs Â· 29 PPV sells Â· 88% reply rate</div>
                  <div class="lb-bar-wrap"><div class="lb-bar" style="width:78%"></div></div>
                </div>
                <div class="lb-revenue">$2,910</div>
              </div>
              <div class="leaderboard-row">
                <div class="lb-rank bronze">3</div>
                <div class="lb-av" style="background:linear-gradient(135deg,#a78bfa,#7c5cfc)">D</div>
                <div class="lb-info">
                  <div class="lb-name">Dan K.</div>
                  <div class="lb-stats">97 msgs Â· 21 PPV sells Â· 84% reply rate</div>
                  <div class="lb-bar-wrap"><div class="lb-bar" style="width:58%"></div></div>
                </div>
                <div class="lb-revenue">$2,140</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Revenue chart -->
        <div class="card">
          <div class="card-header">
            <div><div class="card-title">7-Day Revenue</div><div class="card-subtitle">All accounts combined</div></div>
            <div style="font-family:'DM Mono',monospace;font-size:20px;font-weight:700;color:var(--green)">$14.2k</div>
          </div>
          <div class="card-body">
            <div class="chart-bar-container" id="dashChart"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PAGE: MESSAGE PRO
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-message-pro" style="padding:0;overflow:hidden">
      <div class="msgpro-shell" style="flex-direction:column">
        <!-- Model strip -->
        <div style="display:flex;flex-direction:column;flex:1;overflow:hidden">
          <div class="model-strip" id="modelStrip">
            <div class="model-tab active" onclick="switchModel(0,this)">
              <div class="model-tab-av" style="background:linear-gradient(135deg,#667eea,#764ba2)">S</div>
              Sophia Rose <span class="model-tab-unread">5</span>
            </div>
            <div class="model-tab" onclick="switchModel(1,this)">
              <div class="model-tab-av" style="background:linear-gradient(135deg,#f093fb,#f5576c)">A</div>
              Ava Monroe <span class="model-tab-unread">12</span>
            </div>
            <div class="model-tab" onclick="switchModel(2,this)">
              <div class="model-tab-av" style="background:linear-gradient(135deg,#4facfe,#00f2fe)">L</div>
              Luna Sky
            </div>
            <div class="add-acct-btn" title="Connect account" onclick="openModal('connectModal')">+</div>
          </div>

          <!-- 3-col layout -->
          <div style="flex:1;display:flex;overflow:hidden">
            <!-- Inbox -->
            <div class="inbox-rail">
              <div class="inbox-top">
                <input class="inbox-search" type="text" placeholder="Search fansâ€¦" oninput="filterInbox(this.value)" />
                <div class="inbox-filters">
                  <button class="ifilter active" onclick="setIF('all',this)">All</button>
                  <button class="ifilter" onclick="setIF('unread',this)">Unread</button>
                  <button class="ifilter" onclick="setIF('whale',this)">ğŸ‹ Whale</button>
                  <button class="ifilter" onclick="setIF('followup',this)">Follow-up</button>
                </div>
              </div>
              <div class="inbox-list" id="inboxList"></div>
            </div>

            <!-- Chat col -->
            <div class="chat-col">
              <!-- Sub-tabs -->
              <div class="sub-tabs" id="subTabs">
                <span class="stab-label">Open chats:</span>
              </div>

              <div class="lock-warn" id="lockWarn">âš  <span id="lockWarnTxt">Another chatter is viewing this</span></div>

              <!-- Thread -->
              <div class="chat-thread-area" id="chatThread">
                <div class="chat-empty-state" id="chatEmptyState">
                  <div class="icon">ğŸ’¬</div>
                  <div style="font-size:13px">Select a conversation</div>
                </div>
              </div>

              <!-- Script runner -->
              <div class="script-runner" id="scriptRunner">
                <div class="sr-header">
                  <div class="sr-title">â–¶ <span id="srName">Script</span></div>
                  <div class="sr-progress">
                    <div class="sr-dots" id="srDots"></div>
                    <span class="sr-step-label" id="srStepLabel">Step 1/4</span>
                  </div>
                </div>
                <div class="sr-content" id="srContent"></div>
                <div class="sr-note" id="srNote"></div>
                <div class="sr-actions">
                  <button class="tool-btn" style="font-size:11px" onclick="insertScriptStep()">ğŸ“‹ Insert</button>
                  <button class="tool-btn" style="font-size:11px" onclick="sendScriptStep()">Send now â†—</button>
                  <button class="tool-btn" style="font-size:11px" onclick="skipStep()">Skip â†’</button>
                  <button class="tool-btn btn-danger" style="font-size:11px;border-radius:6px;padding:4px 9px" onclick="abandonScript()">âœ• End</button>
                </div>
              </div>

              <!-- Snippets -->
              <div class="snip-panel" id="snipPanel">
                <input class="snip-search" type="text" placeholder="Search saved repliesâ€¦" oninput="filterSnips(this.value)" />
                <div class="snip-grid" id="snipGrid"></div>
              </div>

              <!-- Composer -->
              <div class="composer">
                <div class="composer-tools">
                  <button class="tool-btn" id="snipBtn" onclick="toggleSnips()">ğŸ’¬ Saved replies</button>
                  <button class="tool-btn" id="scriptBtn" onclick="startScriptMenu()">â–¶ Scripts</button>
                  <button class="tool-btn" id="ppvBtn" onclick="togglePPV()">ğŸ”’ PPV</button>
                  <input class="ppv-price" id="ppvPrice" type="number" placeholder="$40" min="1" max="999" />
                  <button class="tool-btn" onclick="toast('Media upload coming soon!')">ğŸ“ Media</button>
                  <span class="char-ct" id="charCt">0 / 500</span>
                </div>
                <div class="composer-row">
                  <textarea class="composer-ta" id="composerTa" placeholder="Type a messageâ€¦" rows="1"
                    oninput="onTaInput(this)" onkeydown="onTaKey(event)"></textarea>
                  <button class="send-btn" id="sendBtn" onclick="sendMsg()">â†‘</button>
                </div>
              </div>
            </div>

            <!-- CRM Panel -->
            <div class="crm-panel" id="crmPanel">
              <div class="crm-sec">
                <div class="fan-head">
                  <div class="fan-av-lg" id="crmAv" style="background:var(--s4)">?</div>
                  <div>
                    <div class="fan-name" id="crmName">No fan selected</div>
                    <div class="fan-handle" id="crmHandle">â€”</div>
                  </div>
                </div>
              </div>
              <div class="crm-sec">
                <div class="crm-sec-title">Spend Intelligence</div>
                <div class="stat-row-sm"><span class="srs-label">Lifetime spend</span><span class="srs-value green" id="crmLifetime">â€”</span></div>
                <div class="stat-row-sm"><span class="srs-label">Last 30 days</span><span class="srs-value" id="crm30d">â€”</span></div>
                <div class="stat-row-sm"><span class="srs-label">PPV unlock rate</span><span class="srs-value accent" id="crmPpv">â€”</span></div>
                <div class="stat-row-sm"><span class="srs-label">Spend tier</span><span id="crmTier" class="badge badge-whale">â€”</span></div>
                <div class="stat-row-sm"><span class="srs-label">Sub status</span><span class="srs-value" id="crmSub">â€”</span></div>
              </div>
              <div class="crm-sec">
                <div class="crm-sec-title">Tags</div>
                <div class="tags-row" id="crmTags"></div>
                <div class="tag-add-row">
                  <input class="tag-input" type="text" placeholder="Add tagâ€¦" id="tagIn" onkeydown="if(event.key==='Enter')addTag()" />
                  <button class="btn btn-ghost btn-sm" onclick="addTag()">+</button>
                </div>
              </div>
              <div class="crm-sec">
                <div class="crm-sec-title">Internal Notes</div>
                <textarea class="notes-ta" id="crmNotes" placeholder="Private notes â€” not visible to fanâ€¦" onblur="toast('Note saved')"></textarea>
                <button class="btn btn-ghost btn-sm" style="width:100%;justify-content:center" onclick="toast('Note saved')">Save note</button>
              </div>
              <div class="crm-sec">
                <div class="crm-sec-title">Quick Actions</div>
                <button class="crm-action-btn accent" onclick="startScriptMenu()">â–¶ Run a script</button>
                <button class="crm-action-btn" onclick="toast('Follow-up set!')">ğŸ”” Set follow-up</button>
                <button class="crm-action-btn" onclick="toast('Assign to chatter coming!')">ğŸ‘¤ Assign chatter</button>
              </div>
              <div class="crm-sec">
                <div class="crm-sec-title">Recent Revenue</div>
                <div id="crmRevenue" style="font-size:11px;color:var(--text3)">Select a fan to see revenue</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PAGE: ANALYTICS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-analytics">
      <div class="page-header">
        <div>
          <div class="page-heading">Analytics</div>
          <div class="page-sub">Revenue attribution Â· Chatter performance Â· Fan intelligence</div>
        </div>
        <div class="flex-row gap-6">
          <button class="btn btn-ghost btn-sm">7d</button>
          <button class="btn btn-primary btn-sm">30d</button>
          <button class="btn btn-ghost btn-sm">90d</button>
        </div>
      </div>

      <div class="grid-4">
        <div class="stat-card"><div class="stat-label">Total Revenue</div><div class="stat-value">$14,280</div><div class="stat-sub"><span class="stat-up">â†‘ 12%</span> vs last period</div></div>
        <div class="stat-card"><div class="stat-label">PPV Revenue</div><div class="stat-value">$6,840</div><div class="stat-sub">48% of total</div></div>
        <div class="stat-card"><div class="stat-label">Subscription Revenue</div><div class="stat-value">$4,980</div><div class="stat-sub">35% of total</div></div>
        <div class="stat-card"><div class="stat-label">Tips</div><div class="stat-value">$2,460</div><div class="stat-sub">17% of total</div></div>
      </div>

      <div class="grid-2">
        <!-- Daily revenue chart -->
        <div class="card">
          <div class="card-header">
            <div><div class="card-title">Daily Revenue</div><div class="card-subtitle">Last 14 days</div></div>
          </div>
          <div class="card-body">
            <div class="chart-bar-container" id="analyticsChart"></div>
          </div>
        </div>

        <!-- Attribution breakdown -->
        <div class="card">
          <div class="card-header"><div class="card-title">Revenue Attribution</div></div>
          <div class="card-body" style="display:flex;flex-direction:column;gap:12px">
            <div>
              <div class="flex-between" style="margin-bottom:4px">
                <span style="font-size:12px;color:var(--text2)">Script-attributed</span>
                <span style="font-size:13px;font-weight:600;color:var(--green)">$4,320 (30%)</span>
              </div>
              <div style="height:6px;background:var(--s4);border-radius:3px"><div style="height:6px;width:30%;background:var(--green);border-radius:3px"></div></div>
            </div>
            <div>
              <div class="flex-between" style="margin-bottom:4px">
                <span style="font-size:12px;color:var(--text2)">Chatter-attributed</span>
                <span style="font-size:13px;font-weight:600;color:var(--accent2)">$7,240 (51%)</span>
              </div>
              <div style="height:6px;background:var(--s4);border-radius:3px"><div style="height:6px;width:51%;background:var(--accent);border-radius:3px"></div></div>
            </div>
            <div>
              <div class="flex-between" style="margin-bottom:4px">
                <span style="font-size:12px;color:var(--text2)">Organic / unattributed</span>
                <span style="font-size:13px;font-weight:600;color:var(--text3)">$2,720 (19%)</span>
              </div>
              <div style="height:6px;background:var(--s4);border-radius:3px"><div style="height:6px;width:19%;background:var(--s5);border-radius:3px"></div></div>
            </div>
            <div style="padding-top:12px;border-top:1px solid var(--border)">
              <div class="stat-row-sm"><span class="srs-label">Top converting script</span><span style="font-size:12px;font-weight:600;color:var(--accent2)">PPV Warm-up Flow</span></div>
              <div class="stat-row-sm"><span class="srs-label">Script conversion rate</span><span style="font-size:12px;font-weight:600;color:var(--green)">44%</span></div>
              <div class="stat-row-sm"><span class="srs-label">Avg revenue per run</span><span style="font-size:12px;font-weight:600;color:var(--text)">$38.40</span></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chatter leaderboard full -->
      <div class="card">
        <div class="card-header">
          <div><div class="card-title">Chatter Leaderboard</div><div class="card-subtitle">Revenue attributed Â· last 30 days</div></div>
        </div>
        <div class="card-body" style="padding:0">
          <div style="padding:4px 20px">
            <div class="leaderboard-row">
              <div class="lb-rank gold">1</div>
              <div class="lb-av" style="background:linear-gradient(135deg,#f59e0b,#ef4444)">J</div>
              <div class="lb-info">
                <div class="lb-name">Jake R.</div>
                <div class="lb-stats">142 msgs sent Â· 38 PPV unlocks Â· 14 scripts run Â· 92% reply rate</div>
                <div class="lb-bar-wrap"><div class="lb-bar" style="width:100%"></div></div>
              </div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:2px">
                <div class="lb-revenue">$3,840</div>
                <span class="badge badge-green">+22%</span>
              </div>
            </div>
            <div class="leaderboard-row">
              <div class="lb-rank silver">2</div>
              <div class="lb-av" style="background:linear-gradient(135deg,#22d3ee,#3b82f6)">S</div>
              <div class="lb-info">
                <div class="lb-name">Sara M.</div>
                <div class="lb-stats">118 msgs sent Â· 29 PPV unlocks Â· 10 scripts run Â· 88% reply rate</div>
                <div class="lb-bar-wrap"><div class="lb-bar" style="width:75%"></div></div>
              </div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:2px">
                <div class="lb-revenue">$2,910</div>
                <span class="badge badge-green">+14%</span>
              </div>
            </div>
            <div class="leaderboard-row">
              <div class="lb-rank bronze">3</div>
              <div class="lb-av" style="background:linear-gradient(135deg,#a78bfa,#7c5cfc)">D</div>
              <div class="lb-info">
                <div class="lb-name">Dan K.</div>
                <div class="lb-stats">97 msgs sent Â· 21 PPV unlocks Â· 8 scripts run Â· 84% reply rate</div>
                <div class="lb-bar-wrap"><div class="lb-bar" style="width:56%"></div></div>
              </div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:2px">
                <div class="lb-revenue">$2,140</div>
                <span class="badge badge-yellow">-3%</span>
              </div>
            </div>
            <div class="leaderboard-row">
              <div class="lb-rank" style="color:var(--text3)">4</div>
              <div class="lb-av" style="background:linear-gradient(135deg,#f97316,#ef4444)">M</div>
              <div class="lb-info">
                <div class="lb-name">Mia T.</div>
                <div class="lb-stats">82 msgs sent Â· 15 PPV unlocks Â· 5 scripts run Â· 79% reply rate</div>
                <div class="lb-bar-wrap"><div class="lb-bar" style="width:40%"></div></div>
              </div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:2px">
                <div class="lb-revenue">$1,390</div>
                <span class="badge badge-red">-8%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PAGE: SCRIPTS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-scripts">
      <div class="page-header">
        <div>
          <div class="page-heading">Scripts & Playbooks</div>
          <div class="page-sub">Build message flows Â· Track conversions Â· Attribute revenue</div>
        </div>
        <button class="btn btn-primary btn-sm" onclick="toast('Script builder coming next!')">ï¼‹ New script</button>
      </div>

      <div class="grid-4">
        <div class="stat-card"><div class="stat-label">Total Runs</div><div class="stat-value">312</div><div class="stat-sub">This month</div></div>
        <div class="stat-card"><div class="stat-label">Conversion Rate</div><div class="stat-value">44%</div><div class="stat-sub"><span class="stat-up">â†‘ 6%</span> vs last month</div></div>
        <div class="stat-card"><div class="stat-label">Script Revenue</div><div class="stat-value">$4,320</div><div class="stat-sub">30% of total rev</div></div>
        <div class="stat-card"><div class="stat-label">Avg Per Run</div><div class="stat-value">$38.40</div><div class="stat-sub">Across all scripts</div></div>
      </div>

      <div class="script-grid">
        <div class="script-card">
          <div class="sc-head">
            <div><div class="sc-name">PPV Warm-up Flow</div></div>
            <span class="badge badge-green">Published</span>
          </div>
          <div class="sc-desc">Build desire before dropping the PPV. 4-step flow from curiosity tease to locked content.</div>
          <div class="sc-steps">
            <div class="sc-step-preview"><div class="sc-step-num">1</div><div class="sc-step-text">Curiosity tease â€” mention you shot something specialâ€¦</div></div>
            <div class="sc-step-preview"><div class="sc-step-num">2</div><div class="sc-step-text">Gauge interest â€” "want me to send it?"</div></div>
            <div class="sc-step-preview"><div class="sc-step-num">3</div><div class="sc-step-text">ğŸ”’ PPV send at $40</div></div>
            <div class="sc-step-preview"><div class="sc-step-num">4</div><div class="sc-step-text">Follow-up if no unlock in 30 min</div></div>
          </div>
          <div class="sc-metrics">
            <div class="sc-metric">Runs: <strong>128</strong></div>
            <div class="sc-metric">Conv: <strong>51%</strong></div>
            <div class="sc-metric">Rev: <strong>$2,612</strong></div>
            <div class="sc-metric">Avg: <strong>$51</strong></div>
          </div>
        </div>
        <div class="script-card">
          <div class="sc-head">
            <div><div class="sc-name">Rebill Save</div></div>
            <span class="badge badge-green">Published</span>
          </div>
          <div class="sc-desc">Catch expiring subscribers before they churn. 2-step soft re-engagement.</div>
          <div class="sc-steps">
            <div class="sc-step-preview"><div class="sc-step-num">1</div><div class="sc-step-text">Soft notice â€” "I'd hate to lose you as a fanâ€¦"</div></div>
            <div class="sc-step-preview"><div class="sc-step-num">2</div><div class="sc-step-text">FOMO â€” tease upcoming exclusive content</div></div>
          </div>
          <div class="sc-metrics">
            <div class="sc-metric">Runs: <strong>84</strong></div>
            <div class="sc-metric">Conv: <strong>38%</strong></div>
            <div class="sc-metric">Rev: <strong>$1,260</strong></div>
            <div class="sc-metric">Avg: <strong>$15</strong></div>
          </div>
        </div>
        <div class="script-card">
          <div class="sc-head">
            <div><div class="sc-name">New Sub Welcome</div></div>
            <span class="badge badge-green">Published</span>
          </div>
          <div class="sc-desc">First impression matters. Warm welcome then guide to best content.</div>
          <div class="sc-steps">
            <div class="sc-step-preview"><div class="sc-step-num">1</div><div class="sc-step-text">Personal welcome + ask their interests</div></div>
            <div class="sc-step-preview"><div class="sc-step-num">2</div><div class="sc-step-text">Personalized content recommendation</div></div>
            <div class="sc-step-preview"><div class="sc-step-num">3</div><div class="sc-step-text">Soft intro to PPV catalogue</div></div>
          </div>
          <div class="sc-metrics">
            <div class="sc-metric">Runs: <strong>100</strong></div>
            <div class="sc-metric">Conv: <strong>29%</strong></div>
            <div class="sc-metric">Rev: <strong>$448</strong></div>
            <div class="sc-metric">Avg: <strong>$4.50</strong></div>
          </div>
        </div>
        <div class="script-card" style="border-style:dashed;cursor:pointer;opacity:.7" onclick="toast('Script builder coming next!')">
          <div style="height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;min-height:160px">
            <div style="font-size:28px">ï¼‹</div>
            <div style="font-size:13px;font-weight:600;color:var(--text2)">Create new script</div>
            <div style="font-size:11px;color:var(--text3)">Build a custom playbook</div>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PAGE: TEAM
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-team">
      <div class="page-header">
        <div>
          <div class="page-heading">Team Management</div>
          <div class="page-sub">Invite chatters Â· Assign models Â· Track performance</div>
        </div>
        <button class="btn btn-primary btn-sm" onclick="openModal('inviteModal')">ï¼‹ Invite member</button>
      </div>

      <div class="team-grid">
        <div class="team-card">
          <div class="tc-head">
            <div class="tc-av" style="background:linear-gradient(135deg,#f59e0b,#ef4444)">J</div>
            <div>
              <div class="tc-name">Jake R.</div>
              <div class="tc-role">ğŸŸ¢ Chatter Â· Online now</div>
            </div>
          </div>
          <div class="tc-accounts">Assigned: Sophia Rose, Ava Monroe</div>
          <div class="tc-metrics">
            <div class="tc-metric"><div class="tc-metric-label">Revenue</div><div class="tc-metric-value">$3,840</div></div>
            <div class="tc-metric"><div class="tc-metric-label">PPV Sells</div><div class="tc-metric-value">38</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Scripts</div><div class="tc-metric-value">14</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Reply Rate</div><div class="tc-metric-value">92%</div></div>
          </div>
        </div>
        <div class="team-card">
          <div class="tc-head">
            <div class="tc-av" style="background:linear-gradient(135deg,#22d3ee,#3b82f6)">S</div>
            <div>
              <div class="tc-name">Sara M.</div>
              <div class="tc-role">ğŸŸ¢ Chatter Â· Online now</div>
            </div>
          </div>
          <div class="tc-accounts">Assigned: Ava Monroe, Luna Sky</div>
          <div class="tc-metrics">
            <div class="tc-metric"><div class="tc-metric-label">Revenue</div><div class="tc-metric-value">$2,910</div></div>
            <div class="tc-metric"><div class="tc-metric-label">PPV Sells</div><div class="tc-metric-value">29</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Scripts</div><div class="tc-metric-value">10</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Reply Rate</div><div class="tc-metric-value">88%</div></div>
          </div>
        </div>
        <div class="team-card">
          <div class="tc-head">
            <div class="tc-av" style="background:linear-gradient(135deg,#a78bfa,#7c5cfc)">D</div>
            <div>
              <div class="tc-name">Dan K.</div>
              <div class="tc-role">ğŸŸ¡ Chatter Â· Away</div>
            </div>
          </div>
          <div class="tc-accounts">Assigned: Sophia Rose</div>
          <div class="tc-metrics">
            <div class="tc-metric"><div class="tc-metric-label">Revenue</div><div class="tc-metric-value">$2,140</div></div>
            <div class="tc-metric"><div class="tc-metric-label">PPV Sells</div><div class="tc-metric-value">21</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Scripts</div><div class="tc-metric-value">8</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Reply Rate</div><div class="tc-metric-value">84%</div></div>
          </div>
        </div>
        <div class="team-card">
          <div class="tc-head">
            <div class="tc-av" style="background:linear-gradient(135deg,#f97316,#ef4444)">M</div>
            <div>
              <div class="tc-name">Mia T.</div>
              <div class="tc-role">âš« Chatter Â· Offline</div>
            </div>
          </div>
          <div class="tc-accounts">Assigned: Luna Sky</div>
          <div class="tc-metrics">
            <div class="tc-metric"><div class="tc-metric-label">Revenue</div><div class="tc-metric-value">$1,390</div></div>
            <div class="tc-metric"><div class="tc-metric-label">PPV Sells</div><div class="tc-metric-value">15</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Scripts</div><div class="tc-metric-value">5</div></div>
            <div class="tc-metric"><div class="tc-metric-label">Reply Rate</div><div class="tc-metric-value">79%</div></div>
          </div>
        </div>
        <div class="team-card" style="border-style:dashed;cursor:pointer;opacity:.6" onclick="openModal('inviteModal')">
          <div style="height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:7px;min-height:160px">
            <div style="font-size:26px">ï¼‹</div>
            <div style="font-size:13px;font-weight:600;color:var(--text2)">Invite a chatter</div>
            <div style="font-size:11px;color:var(--text3)">Send an invite email</div>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         PAGE: ACCOUNTS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-accounts">
      <div class="page-header">
        <div>
          <div class="page-heading">Connected Accounts</div>
          <div class="page-sub">Manage Fanvue model connections Â· OAuth tokens Â· Sync status</div>
        </div>
        <button class="btn btn-primary btn-sm" onclick="openModal('connectModal')">ï¼‹ Connect account</button>
      </div>

      <div class="grid-3">
        <div class="account-card">
          <div class="flex-between" style="margin-bottom:12px">
            <div class="account-avatar" style="width:44px;height:44px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:white;position:relative">
              S <div class="account-avatar-status"></div>
            </div>
            <span class="badge badge-green">â— Connected</span>
          </div>
          <div class="account-name">Sophia Rose</div>
          <div class="account-handle" style="margin-bottom:10px">@sophiarose Â· Fanvue ID: fv_10291</div>
          <div class="account-stats">
            <div class="account-stat"><div class="account-stat-label">Subscribers</div><div class="account-stat-value">312</div></div>
            <div class="account-stat"><div class="account-stat-label">Monthly Rev</div><div class="account-stat-value">$5.2k</div></div>
            <div class="account-stat"><div class="account-stat-label">Last Sync</div><div class="account-stat-value" style="font-size:11px">2m ago</div></div>
            <div class="account-stat"><div class="account-stat-label">Token</div><div class="account-stat-value" style="color:var(--green);font-size:11px">Valid</div></div>
          </div>
          <div style="display:flex;gap:6px;margin-top:10px">
            <button class="btn btn-ghost btn-sm" style="flex:1;justify-content:center" onclick="toast('Sync triggered!')">Sync now</button>
            <button class="btn btn-ghost btn-sm" onclick="toast('Settings coming!')">âš™</button>
          </div>
        </div>
        <div class="account-card">
          <div class="flex-between" style="margin-bottom:12px">
            <div class="account-avatar" style="width:44px;height:44px;background:linear-gradient(135deg,#f093fb,#f5576c);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:white;position:relative">
              A <div class="account-avatar-status"></div>
            </div>
            <span class="badge badge-green">â— Connected</span>
          </div>
          <div class="account-name">Ava Monroe</div>
          <div class="account-handle" style="margin-bottom:10px">@avamonroe Â· Fanvue ID: fv_20483</div>
          <div class="account-stats">
            <div class="account-stat"><div class="account-stat-label">Subscribers</div><div class="account-stat-value">401</div></div>
            <div class="account-stat"><div class="account-stat-label">Monthly Rev</div><div class="account-stat-value">$6.1k</div></div>
            <div class="account-stat"><div class="account-stat-label">Last Sync</div><div class="account-stat-value" style="font-size:11px">1m ago</div></div>
            <div class="account-stat"><div class="account-stat-label">Token</div><div class="account-stat-value" style="color:var(--green);font-size:11px">Valid</div></div>
          </div>
          <div style="display:flex;gap:6px;margin-top:10px">
            <button class="btn btn-ghost btn-sm" style="flex:1;justify-content:center" onclick="toast('Sync triggered!')">Sync now</button>
            <button class="btn btn-ghost btn-sm" onclick="toast('Settings coming!')">âš™</button>
          </div>
        </div>
        <div class="account-card">
          <div class="flex-between" style="margin-bottom:12px">
            <div class="account-avatar" style="width:44px;height:44px;background:linear-gradient(135deg,#4facfe,#00f2fe);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:white;position:relative">
              L <div class="account-avatar-status"></div>
            </div>
            <span class="badge badge-green">â— Connected</span>
          </div>
          <div class="account-name">Luna Sky</div>
          <div class="account-handle" style="margin-bottom:10px">@lunasky Â· Fanvue ID: fv_31847</div>
          <div class="account-stats">
            <div class="account-stat"><div class="account-stat-label">Subscribers</div><div class="account-stat-value">134</div></div>
            <div class="account-stat"><div class="account-stat-label">Monthly Rev</div><div class="account-stat-value">$2.9k</div></div>
            <div class="account-stat"><div class="account-stat-label">Last Sync</div><div class="account-stat-value" style="font-size:11px">4m ago</div></div>
            <div class="account-stat"><div class="account-stat-label">Token</div><div class="account-stat-value" style="color:var(--green);font-size:11px">Valid</div></div>
          </div>
          <div style="display:flex;gap:6px;margin-top:10px">
            <button class="btn btn-ghost btn-sm" style="flex:1;justify-content:center" onclick="toast('Sync triggered!')">Sync now</button>
            <button class="btn btn-ghost btn-sm" onclick="toast('Settings coming!')">âš™</button>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- MODAL: Invite team member -->
<div class="modal-overlay" id="inviteModal" onclick="if(event.target===this)closeModal('inviteModal')">
  <div class="modal">
    <div class="modal-title">Invite Team Member</div>
    <div class="modal-sub">They'll receive an email with login instructions</div>
    <div class="form-field">
      <label class="form-label">Full Name</label>
      <input class="form-input" type="text" placeholder="e.g. Alex Johnson" />
    </div>
    <div class="form-field">
      <label class="form-label">Email Address</label>
      <input class="form-input" type="email" placeholder="alex@agency.com" />
    </div>
    <div class="form-field">
      <label class="form-label">Role</label>
      <select class="form-input">
        <option>Chatter</option>
        <option>Manager</option>
      </select>
    </div>
    <div class="form-field">
      <label class="form-label">Assign to Models</label>
      <div style="display:flex;flex-direction:column;gap:8px;padding:8px 0">
        <label style="display:flex;align-items:center;gap:8px;font-size:13px;color:var(--text2);cursor:pointer"><input type="checkbox" style="accent-color:var(--accent)"> Sophia Rose</label>
        <label style="display:flex;align-items:center;gap:8px;font-size:13px;color:var(--text2);cursor:pointer"><input type="checkbox" style="accent-color:var(--accent)"> Ava Monroe</label>
        <label style="display:flex;align-items:center;gap:8px;font-size:13px;color:var(--text2);cursor:pointer"><input type="checkbox" style="accent-color:var(--accent)"> Luna Sky</label>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('inviteModal')">Cancel</button>
      <button class="btn btn-primary" onclick="closeModal('inviteModal');toast('Invite sent!')">Send Invite</button>
    </div>
  </div>
</div>

<!-- MODAL: Connect Fanvue account -->
<div class="modal-overlay" id="connectModal" onclick="if(event.target===this)closeModal('connectModal')">
  <div class="modal">
    <div class="modal-title">Connect Fanvue Account</div>
    <div class="modal-sub">Authorize FlowDesk to manage this model's account via OAuth</div>
    <div class="form-field">
      <label class="form-label">Account Label</label>
      <input class="form-input" type="text" placeholder="e.g. Model Name" />
    </div>
    <div style="background:var(--s3);border:1px solid var(--border2);border-radius:10px;padding:14px;margin-bottom:16px">
      <div style="font-size:12px;color:var(--text2);line-height:1.6">
        Clicking "Connect via Fanvue" will redirect to Fanvue's authorization page.<br>
        FlowDesk will receive a token to read messages, stats, and send messages on behalf of this account.<br><br>
        <span style="color:var(--text3)">Tokens are encrypted with AES-256-GCM and never stored in plaintext.</span>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('connectModal')">Cancel</button>
      <button class="btn btn-primary" onclick="closeModal('connectModal');toast('Redirecting to Fanvue OAuth...')">Connect via Fanvue â†’</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const MODELS=[
  {name:'Sophia Rose',handle:'@sophiarose',color:'linear-gradient(135deg,#667eea,#764ba2)',init:'S',unread:5},
  {name:'Ava Monroe',handle:'@avamonroe',color:'linear-gradient(135deg,#f093fb,#f5576c)',init:'A',unread:12},
  {name:'Luna Sky',handle:'@lunasky',color:'linear-gradient(135deg,#4facfe,#00f2fe)',init:'L',unread:0}
];

const FANS={
  0:[
    {id:1,name:'BigSpender99',handle:'@bigspender99',tier:'whale',unread:3,preview:'Can you send me that set?',time:'2m',lifetime:840,spend30:320,ppvRate:88,sub:'Active',tags:['whale','vip'],av:'B',col:'linear-gradient(135deg,#a78bfa,#7c5cfc)',txns:[{t:'PPV Unlock',a:40,d:'Today'},{t:'Tip',a:25,d:'Yesterday'},{t:'Sub renewal',a:14.99,d:'3 days ago'}]},
    {id:2,name:'LoyalFan_22',handle:'@loyalfan22',tier:'dolphin',unread:1,preview:'Love the new content!',time:'15m',lifetime:280,spend30:80,ppvRate:55,sub:'Active',tags:['loyal'],av:'L',col:'linear-gradient(135deg,#43e97b,#38f9d7)',txns:[{t:'Tip',a:10,d:'2 days ago'},{t:'PPV Unlock',a:25,d:'Last week'}]},
    {id:3,name:'NewFan_Josh',handle:'@newfan_josh',tier:'low',unread:0,preview:'Hey! Just subscribed ğŸ˜Š',time:'1h',lifetime:14.99,spend30:14.99,ppvRate:0,sub:'Active',tags:[],av:'N',col:'linear-gradient(135deg,#f7971e,#ffd200)',txns:[{t:'Subscription',a:14.99,d:'Today'}]},
    {id:4,name:'OldTimer_44',handle:'@oldtimer44',tier:'dolphin',unread:2,preview:'Miss your old content style',time:'3h',lifetime:450,spend30:0,ppvRate:40,sub:'Rebill OFF',tags:['at-risk'],av:'O',col:'linear-gradient(135deg,#ee0979,#ff6a00)',txns:[{t:'PPV Unlock',a:20,d:'3 weeks ago'}]},
    {id:5,name:'SilentWatcher',handle:'@silentwatcher',tier:'whale',unread:0,preview:'(no reply in 3 days)',time:'3d',lifetime:1200,spend30:0,ppvRate:72,sub:'Active',tags:['whale','inactive'],av:'S',col:'linear-gradient(135deg,#4facfe,#00f2fe)',txns:[{t:'PPV Unlock',a:60,d:'Last week'},{t:'Tip',a:100,d:'2 weeks ago'}]}
  ],
  1:[
    {id:6,name:'TopTipper_X',handle:'@toptipper_x',tier:'whale',unread:8,preview:'Ready for tonight?',time:'1m',lifetime:2400,spend30:600,ppvRate:95,sub:'Active',tags:['whale','priority'],av:'T',col:'linear-gradient(135deg,#f093fb,#f5576c)',txns:[{t:'Tip',a:200,d:'Today'},{t:'PPV Unlock',a:80,d:'Yesterday'}]},
    {id:7,name:'HungryForMore',handle:'@hungrymore',tier:'dolphin',unread:4,preview:'When is the next PPV?',time:'5m',lifetime:380,spend30:120,ppvRate:65,sub:'Active',tags:['hot'],av:'H',col:'linear-gradient(135deg,#43e97b,#38f9d7)',txns:[{t:'PPV Unlock',a:35,d:'Today'}]}
  ],
  2:[
    {id:8,name:'LoyalSub_88',handle:'@loyalsub88',tier:'dolphin',unread:0,preview:'Thanks for the reply!',time:'30m',lifetime:210,spend30:60,ppvRate:50,sub:'Active',tags:['loyal'],av:'L',col:'linear-gradient(135deg,#4facfe,#00f2fe)',txns:[{t:'Sub renewal',a:14.99,d:'Yesterday'}]}
  ]
};

const SNIPPETS=[
  {id:1,title:'Welcome new sub',body:"Hey {{fan_name}}! Welcome, I'm so happy you're here ğŸ’• Any special requests?",ppv:false},
  {id:2,title:'PPV tease',body:"I just shot something really special for youâ€¦ I think you're going to love it ğŸ”¥",ppv:false},
  {id:3,title:'Locked PPV',body:"I made this just for my special fans ğŸ”’ Only ${{price}} â€” I promise it's worth it ğŸ’‹",ppv:true},
  {id:4,title:'Re-engagement',body:"Hey {{fan_name}}, I've been thinking about you ğŸ’­ I've posted some new stuff you'd loveâ€¦",ppv:false},
  {id:5,title:'Tip thank you',body:"Omg {{fan_name}} thank you SO much for the tip!! You're literally the sweetest ğŸ¥ºğŸ’•",ppv:false},
  {id:6,title:'Rebill reminder',body:"Hey babe! Just wanted to let you know your sub is expiring soonâ€¦ I'd hate to lose you ğŸ’”",ppv:false}
];

const SCRIPTS=[
  {id:1,name:'PPV Warm-up Flow',steps:[
    {content:"Hey {{fan_name}}! I've been thinking about you ğŸ‘€ I shot something this week that I only want my favorites to seeâ€¦",note:'Build curiosity â€” wait for response'},
    {content:"It's pretty spicyâ€¦ want me to send it your way? I'll give you a sneak peek first ğŸ”¥",note:'Gauge interest â€” proceed if they say yes'},
    {content:"Sending it now! It's locked at $40 but trust me it's SO worth it ğŸ”’ğŸ’•",note:'PPV message â€” attach the locked content',ppv:true,price:40},
    {content:"Did you get a chance to check it out? I'd love to know what you thought ğŸ˜˜",note:'Follow-up if no unlock after 30 min'}
  ]},
  {id:2,name:'Rebill Save',steps:[
    {content:"Hey {{fan_name}}, I noticed your sub might be expiring soon ğŸ’” I'd hate to lose you as a fanâ€¦",note:'Soft tone â€” do not be pushy'},
    {content:"I've got SO much exclusive content coming up this month ğŸ‰ Thinking of you!",note:'Create FOMO'}
  ]}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentModel=0,currentFanId=null,currentFilter='all';
let openTabs={0:[],1:[],2:[]},activeFan={0:null,1:null,2:null};
let ppvOn=false,snipsOpen=false;
let scriptOn=false,curScript=null,curStep=0;
let msgStore={};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const pageTitles={
  dashboard:'<strong>Dashboard</strong>',
  'message-pro':'<strong>Message Pro</strong> â€” Unified Inbox',
  analytics:'<strong>Analytics</strong> â€” Revenue & Attribution',
  scripts:'<strong>Scripts</strong> â€” Playbooks & Flows',
  team:'<strong>Team</strong> â€” Chatters & Managers',
  accounts:'<strong>Accounts</strong> â€” Connected Models'
};

function goTo(pageId,navEl){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.getElementById('page-'+pageId).classList.add('active');
  if(navEl)navEl.classList.add('active');
  document.getElementById('pageTitle').innerHTML=pageTitles[pageId]||'';
  if(pageId==='message-pro'){renderInbox();renderSubTabs();}
}

function goToNav(pageId){
  const navEl=document.querySelector(`[onclick="goTo('${pageId}',this)"]`);
  goTo(pageId,navEl);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHARTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderChart(containerId,data){
  const el=document.getElementById(containerId);if(!el)return;
  const max=Math.max(...data.map(d=>d.v));
  el.innerHTML=data.map(d=>`
    <div class="chart-bar-wrap">
      <div class="chart-bar" data-val="$${d.v}" style="height:${Math.max(8,(d.v/max)*100)}px"></div>
      <div class="chart-label">${d.l}</div>
    </div>`).join('');
}

const d7=[
  {l:'Mon',v:1820},{l:'Tue',v:2140},{l:'Wed',v:1680},{l:'Thu',v:2380},
  {l:'Fri',v:1950},{l:'Sat',v:2820},{l:'Sun',v:1490}
];
const d14=[
  {l:'7',v:1200},{l:'8',v:980},{l:'9',v:1480},{l:'10',v:1680},
  {l:'11',v:2100},{l:'12',v:1820},{l:'13',v:2380},{l:'14',v:1950},
  {l:'15',v:2640},{l:'16',v:1780},{l:'17',v:2280},{l:'18',v:2820},
  {l:'19',v:1640},{l:'20',v:1290}
];

setTimeout(()=>{renderChart('dashChart',d7);renderChart('analyticsChart',d14)},100);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTIVITY FEED
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ACTIVITIES=[
  {text:'<strong>BigSpender99</strong> unlocked a PPV from <strong>Sophia Rose</strong>',amount:'$40',color:'var(--green)',dot:'var(--green)'},
  {text:'<strong>TopTipper_X</strong> left a tip on <strong>Ava Monroe</strong>',amount:'$200',color:'var(--yellow)',dot:'var(--yellow)'},
  {text:'<strong>NewFan_Josh</strong> subscribed to <strong>Sophia Rose</strong>',amount:'$14.99',color:'var(--accent2)',dot:'var(--accent)'},
  {text:'<strong>HungryForMore</strong> unlocked a PPV from <strong>Ava Monroe</strong>',amount:'$35',color:'var(--green)',dot:'var(--green)'},
  {text:'<strong>LoyalFan_22</strong> renewed subscription to <strong>Sophia Rose</strong>',amount:'$14.99',color:'var(--accent2)',dot:'var(--accent)'},
  {text:'<strong>SilentWatcher</strong> left a tip on <strong>Sophia Rose</strong>',amount:'$100',color:'var(--yellow)',dot:'var(--yellow)'},
];
let actIdx=0;
function refreshFeed(){
  const feed=document.getElementById('activityFeed');if(!feed)return;
  const times=['just now','1m ago','2m ago','4m ago','8m ago','12m ago'];
  feed.innerHTML=ACTIVITIES.map((a,i)=>`
    <div class="activity-item">
      <div class="activity-dot" style="background:${a.dot}"></div>
      <div class="activity-text">${a.text}</div>
      <div class="activity-time">${times[i]}</div>
      <div class="activity-amount">${a.amount}</div>
    </div>`).join('');
}
refreshFeed();
setInterval(()=>{
  ACTIVITIES.unshift(ACTIVITIES.pop());
  document.querySelectorAll('.activity-item').forEach((el,i)=>{
    const times=['just now','1m ago','2m ago','4m ago','8m ago','12m ago'];
    el.querySelector('.activity-time').textContent=times[i];
  });
},5000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODEL TABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchModel(idx,el){
  currentModel=idx;
  document.querySelectorAll('.model-tab').forEach(t=>t.classList.remove('active'));
  el.classList.add('active');
  renderInbox();renderSubTabs();
  if(activeFan[idx])loadConvo(activeFan[idx]);
  else clearChat();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INBOX
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderInbox(search=''){
  const list=document.getElementById('inboxList');if(!list)return;
  let fans=FANS[currentModel]||[];
  if(currentFilter==='unread')fans=fans.filter(f=>f.unread>0);
  if(currentFilter==='whale')fans=fans.filter(f=>f.tier==='whale');
  if(currentFilter==='followup')fans=fans.filter(f=>f.tags.includes('at-risk')||f.tags.includes('inactive'));
  if(search)fans=fans.filter(f=>f.name.toLowerCase().includes(search.toLowerCase()));
  list.innerHTML=fans.map(f=>`
    <div class="convo-row ${activeFan[currentModel]===f.id?'active':''}" onclick="openFan(${f.id})">
      <div class="cr-top">
        <div class="cr-av cr-av-online" style="background:${f.col}">${f.av}</div>
        <div class="cr-name">${f.name}</div>
        <div class="cr-time">${f.time}</div>
        ${f.unread>0?`<div class="cr-unread">${f.unread}</div>`:''}
      </div>
      <div class="cr-preview">${f.preview}</div>
      <div class="cr-meta">
        <span class="badge badge-${f.tier}" style="font-size:9px">${f.tier}</span>
        ${f.tags.includes('at-risk')?'<span style="font-size:9px;color:var(--red)">âš  at-risk</span>':''}
        <span style="margin-left:auto;font-size:10px;color:var(--text3)">$${f.lifetime}</span>
      </div>
    </div>`).join('');
}
function setIF(f,el){
  currentFilter=f;
  document.querySelectorAll('.ifilter').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');renderInbox();
}
function filterInbox(v){renderInbox(v);}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FAN / CONVO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getFan(id){for(const m of Object.values(FANS)){const f=m.find(x=>x.id===id);if(f)return f;}}

function openFan(id){
  if(!openTabs[currentModel].includes(id))openTabs[currentModel].push(id);
  activeFan[currentModel]=id;currentFanId=id;
  renderInbox();renderSubTabs();loadConvo(id);loadCRM(id);
}

function loadConvo(id){
  activeFan[currentModel]=id;currentFanId=id;
  document.getElementById('chatEmptyState').style.display='none';
  if(!msgStore[id])msgStore[id]=genMsgs(getFan(id));
  renderMsgs(id);renderInbox();renderSubTabs();
}

function clearChat(){
  document.getElementById('chatThread').innerHTML='<div class="chat-empty-state" id="chatEmptyState"><div class="icon">ğŸ’¬</div><div style="font-size:13px">Select a conversation</div></div>';
  loadCRM(null);
}

function genMsgs(fan){
  const now=Date.now();
  return[
    {dir:'in',content:'Hey! Just subscribed ğŸ˜Š',t:now-86400000*2},
    {dir:'out',content:`Hey ${fan.name}! Welcome, so glad you're here ğŸ’• Any special requests?`,t:now-86400000*2+300000},
    {dir:'in',content:'Thank you! Your content is amazing',t:now-86400000},
    {dir:'out',content:"Aww that means so much ğŸ¥º I've been working really hard on it!",t:now-86400000+600000},
    {dir:'in',content:fan.preview,t:now-60000*3}
  ];
}

function renderMsgs(id){
  const fan=getFan(id),msgs=msgStore[id]||[];
  const thread=document.getElementById('chatThread');
  let html='<div class="date-sep"><span>Today</span></div>';
  msgs.forEach(m=>{
    const t=new Date(m.t).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
    html+=`<div class="msg-row ${m.dir} ${m.ppv?'ppv':''}">
      ${m.dir==='in'?`<div class="msg-av" style="background:${fan.col}">${fan.av}</div>`:''}
      <div class="msg-wrap">
        ${m.ppv?`<div class="msg-ppv-tag">ğŸ”’ PPV Â· $${m.price}</div>`:''}
        <div class="msg-bubble">${m.content}</div>
        <div class="msg-meta">${t}${m.dir==='out'&&m.by?` Â· ${m.by}`:''}</div>
      </div>
      ${m.dir==='out'?`<div class="msg-av" style="background:var(--accent)">MT</div>`:''}
    </div>`;
  });
  thread.innerHTML=html;
  thread.scrollTop=thread.scrollHeight;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUB-TABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderSubTabs(){
  const c=document.getElementById('subTabs');if(!c)return;
  const tabs=openTabs[currentModel]||[];
  let h='<span class="stab-label">Open:</span>';
  if(!tabs.length)h+='<span style="font-size:10px;color:var(--text3)">Click a fan to open</span>';
  else tabs.forEach(id=>{
    const f=getFan(id);if(!f)return;
    h+=`<div class="sub-tab ${activeFan[currentModel]===id?'active':''}" onclick="switchSubTab(${id})">
      ${f.unread>0?'<div class="stab-unread"></div>':''}
      ${f.name}
      <span class="stab-close" onclick="closeSubTab(event,${id})">âœ•</span>
    </div>`;
  });
  c.innerHTML=h;
}
function switchSubTab(id){activeFan[currentModel]=id;currentFanId=id;renderSubTabs();loadConvo(id);loadCRM(id);}
function closeSubTab(e,id){
  e.stopPropagation();
  openTabs[currentModel]=openTabs[currentModel].filter(x=>x!==id);
  if(activeFan[currentModel]===id){
    const rem=openTabs[currentModel];
    if(rem.length)switchSubTab(rem[rem.length-1]);
    else{activeFan[currentModel]=null;currentFanId=null;clearChat();}
  }
  renderSubTabs();renderInbox();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CRM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadCRM(id){
  if(!id){
    ['crmName','crmHandle','crmLifetime','crm30d','crmPpv','crmSub'].forEach(k=>{document.getElementById(k).textContent='â€”';});
    document.getElementById('crmAv').textContent='?';
    document.getElementById('crmAv').style.background='var(--s4)';
    document.getElementById('crmTags').innerHTML='';
    document.getElementById('crmRevenue').innerHTML='<span style="font-size:11px;color:var(--text3)">Select a fan</span>';
    return;
  }
  const f=getFan(id);if(!f)return;
  document.getElementById('crmAv').textContent=f.av;
  document.getElementById('crmAv').style.background=f.col;
  document.getElementById('crmName').textContent=f.name;
  document.getElementById('crmHandle').textContent=f.handle;
  document.getElementById('crmLifetime').textContent=`$${f.lifetime}`;
  document.getElementById('crm30d').textContent=`$${f.spend30}`;
  document.getElementById('crmPpv').textContent=`${f.ppvRate}%`;
  const tierEl=document.getElementById('crmTier');
  tierEl.textContent=f.tier.toUpperCase();
  tierEl.className=`badge badge-${f.tier}`;
  const subEl=document.getElementById('crmSub');
  subEl.textContent=f.sub;
  subEl.style.color=f.sub==='Active'?'var(--green)':f.sub.includes('OFF')?'var(--red)':'var(--text2)';
  document.getElementById('crmTags').innerHTML=
    (f.tags||[]).map(t=>`<div class="tag-chip-sm">${t}<span class="tag-rm" onclick="rmTag('${t}')">âœ•</span></div>`).join('');
  document.getElementById('crmRevenue').innerHTML=
    (f.txns||[]).map(r=>`<div class="rev-row"><div><div class="rev-type">${r.t}</div><div class="rev-date">${r.d}</div></div><div class="rev-amount">+$${r.a}</div></div>`).join('');
}
function addTag(){
  const inp=document.getElementById('tagIn');const tag=inp.value.trim().toLowerCase();
  if(!tag||!currentFanId)return;
  const f=getFan(currentFanId);if(!f.tags.includes(tag))f.tags.push(tag);
  loadCRM(currentFanId);inp.value='';
}
function rmTag(tag){const f=getFan(currentFanId);if(!f)return;f.tags=f.tags.filter(t=>t!==tag);loadCRM(currentFanId);}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SNIPPETS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderSnips(q=''){
  const grid=document.getElementById('snipGrid');if(!grid)return;
  const filtered=SNIPPETS.filter(s=>!q||s.title.toLowerCase().includes(q.toLowerCase()));
  grid.innerHTML=filtered.map(s=>`<div class="snip-chip ${s.ppv?'ppv':''}" onclick="insertSnip(${s.id})">${s.ppv?'ğŸ”’ ':''}${s.title}</div>`).join('');
}
function toggleSnips(){
  snipsOpen=!snipsOpen;
  document.getElementById('snipPanel').classList.toggle('open',snipsOpen);
  document.getElementById('snipBtn').classList.toggle('on',snipsOpen);
  if(snipsOpen)renderSnips();
}
function filterSnips(v){renderSnips(v);}
function insertSnip(id){
  const s=SNIPPETS.find(x=>x.id===id);if(!s)return;
  const f=getFan(currentFanId);
  const resolved=s.body.replace(/{{fan_name}}/g,f?.name||'babe');
  const ta=document.getElementById('composerTa');
  ta.value=resolved;onTaInput(ta);
  if(s.ppv&&!ppvOn)togglePPV();
  toggleSnips();ta.focus();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCRIPTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startScriptMenu(){
  if(!currentFanId){toast('Select a fan first');return;}
  startScript(SCRIPTS[0]);
}
function startScript(script){
  curScript=script;curStep=0;scriptOn=true;
  document.getElementById('scriptRunner').classList.add('on');
  document.getElementById('scriptBtn').classList.add('on');
  renderStep();
}
function renderStep(){
  if(!curScript)return;
  const step=curScript.steps[curStep];
  const total=curScript.steps.length;
  const fan=getFan(currentFanId);
  document.getElementById('srName').textContent=curScript.name;
  document.getElementById('srStepLabel').textContent=`Step ${curStep+1} / ${total}`;
  document.getElementById('srContent').textContent=step.content.replace(/{{fan_name}}/g,fan?.name||'babe');
  const noteEl=document.getElementById('srNote');
  if(step.note){noteEl.textContent='ğŸ’¡ '+step.note;noteEl.classList.add('show');}
  else noteEl.classList.remove('show');
  document.getElementById('srDots').innerHTML=curScript.steps.map((_,i)=>`<div class="sr-dot ${i<curStep?'done':i===curStep?'cur':''}"></div>`).join('');
  if(step.ppv&&!ppvOn)togglePPV();
  if(!step.ppv&&ppvOn)togglePPV();
  if(step.price)document.getElementById('ppvPrice').value=step.price;
}
function insertScriptStep(){
  const step=curScript.steps[curStep];const fan=getFan(currentFanId);
  const ta=document.getElementById('composerTa');
  ta.value=step.content.replace(/{{fan_name}}/g,fan?.name||'babe');
  onTaInput(ta);ta.focus();
}
function sendScriptStep(){insertScriptStep();sendMsg();}
function skipStep(){advanceScript(true);}
function advanceScript(){
  curStep++;
  if(curStep>=curScript.steps.length){abandonScript(true);toast('âœ… Script completed!');return;}
  renderStep();
}
function abandonScript(done=false){
  scriptOn=false;curScript=null;curStep=0;
  document.getElementById('scriptRunner').classList.remove('on');
  document.getElementById('scriptBtn').classList.remove('on');
  if(ppvOn)togglePPV();
  if(!done)toast('Script ended');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COMPOSER + PPV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function togglePPV(){
  ppvOn=!ppvOn;
  const btn=document.getElementById('ppvBtn');
  const price=document.getElementById('ppvPrice');
  const send=document.getElementById('sendBtn');
  const ta=document.getElementById('composerTa');
  btn.classList.toggle('ppv-on',ppvOn);
  price.style.display=ppvOn?'block':'none';
  send.classList.toggle('ppv-mode',ppvOn);
  ta.placeholder=ppvOn?'Type your PPV messageâ€¦ content will be locked ğŸ”’':'Type a messageâ€¦';
  if(ppvOn)price.focus();
}
function onTaInput(el){
  el.style.height='auto';el.style.height=Math.min(el.scrollHeight,110)+'px';
  const ct=document.getElementById('charCt');if(ct)ct.textContent=`${el.value.length} / 500`;
}
function onTaKey(e){
  if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMsg();}
  if(e.key==='/'&&e.target.value==='')toggleSnips();
}
function sendMsg(){
  const ta=document.getElementById('composerTa');
  const content=ta.value.trim();
  if(!content||!currentFanId)return;
  const isPpv=ppvOn;
  const price=parseFloat(document.getElementById('ppvPrice').value)||40;
  const fan=getFan(currentFanId);
  if(!msgStore[currentFanId])msgStore[currentFanId]=[];
  msgStore[currentFanId].push({dir:'out',content,t:Date.now(),ppv:isPpv,price:isPpv?price:null,by:'Mike T.'});
  fan.preview=content;fan.unread=0;
  renderMsgs(currentFanId);renderInbox();renderSubTabs();
  ta.value='';ta.style.height='auto';
  const ct=document.getElementById('charCt');if(ct)ct.textContent='0 / 500';
  if(isPpv){toast(`ğŸ”’ PPV sent at $${price}`);togglePPV();}
  if(scriptOn)advanceScript();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL + TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(id){document.getElementById(id).classList.add('open');}
function closeModal(id){document.getElementById(id).classList.remove('open');}
let toastT;
function toast(msg){
  const el=document.getElementById('toast');
  el.textContent=msg;el.style.opacity='1';
  clearTimeout(toastT);toastT=setTimeout(()=>el.style.opacity='0',2500);
}

// INIT: open first fan by default on message pro
document.getElementById('page-message-pro').addEventListener('transitionend',()=>{});
setTimeout(()=>{
  renderSnips();
  if(FANS[0].length)openFan(FANS[0][0].id);
},150);
</script>
</body>
</html>
